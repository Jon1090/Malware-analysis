This is going to be a static analysis of malware found in a pcap I looked at earlier this week (https://github.com/Jon1090/pcap_analysis/tree/main/2019-01-28%20traffic%20analysis). If you would
like to get a sample of this malware, you use the SHA256 sum to grab it off of Virus Total, or if you are feeling adventurous, you can find and extract it from the original pcap at
https://www.malware-traffic-analysis.net/2019/01/28/index.html.

The file name is actiV.bin and the SHA256 sum is: 9f6e3e65aedca997c6445329663bd1d279392a34cfda7d1b56461eb41641fa08

We know this is Dridex from our pcap file analysis (specializing in stealing bannking credentials). Using a few tools quickly confirms this is a Windows Executable. 'File actiV.bin' returns PE32 executable Intel 80386.
Trid suspects it is a DLL or executable, and diec also confirms it is a PE32. Running clamscan does not return a match for this file! 

To get a general overview, I started with capa ('capa -vv actiV.bin'). This reveals anti-debugging instructions, a .rsrc section, the capability to get the memory capacity of the host 
(possibly to detect if it is running in a VM), and the ability to get system info on Windows. Peframe reveals all of the 6 sections: .data, .idata, .rsrc, .reloc, .text *, and CODE *. 
We can see with pecheck that the overall entropy of actiV.bin is very high (it is highly obfuscated and packed with ASProtect v132) at 7.2/8. The highest entropy sections are .text (7.86) 
and CODE (7.59) which is expected as this is where the code for the malware will actually reside. 

Taking a look at the headers, the e_magic is 0x5A4D, a Windows executable. In the image file header we can see the machine code 0x14C for a 32 bit system (can also run on a 64 bit system), and 
confirms the 6 sections mentioned earlier. The optional header has the magic number 0x10B which also indicates this malware can run on 32 bit systems. The address of entry point is 0x2F70, which 
corresponds to the .text section. The major operating system version is 0x5, which can run on any systems running Windows 2000 or later.  

There are several tools that can be used to look for strings in this sample, including pestr, strings, and brxor.py. This file includes the giveaway "!This program cannot be run in DOS mode",
and a few other interesting strings. The purported company name and owner of this 'DirecPLL Library' are Entech Taiwan. There are a couple of strings possibly related to an internet connection
including several mentions of Chrome and 'heatherpDownloadedCuxi17.88', but most of the strings are scrambled. WxHexEditor reveals Dridex is highly obfuscated to hide from static analysis.

A useful tool to pull much of this information in an organized top-down tree format is pe-tree. It can be run by using 'pe-tree mysamplefile'. This tool will conveniently compute sha256 sums 
for each section.

Hybrid-analysis reveals some of the dynamic analysis information we were unable to find statically. This malware send TCP traffic on port 3389 to 192.241.220.183 (be sure to block this IP), a confirmed malicious IP. 
actiV.bin drops several new temp files, modifies the registry, windows services, the kernel security device driver, and more. Dridex is a potent piece of malware engineering.
