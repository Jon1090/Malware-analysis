I am returning to our unknown.exe sample to do a quick follow-up on unpacking and the benefits it can provide in static analysis. This sample as identified
earlier, is packed using UPX. Fortunately, this is an easy packer to find and use to unpack the sample. After unpacking unknown.exe (renamed as 'win' in
the accompanying photos), the SHA256 sum is: d48887b4f93897c107481f936d69c50596bc6c289c7e160999aad9dab7391129. Virus Total will also alert on this sample. 

Unpacking unknown.exe reduces the file entropy from 7.72 to 5.83. While still high and sections are still obfuscated, I can find and read many more interesting
strings than beforehand. First off, we can read the image section headers as .text, .rdata, and .data, instead of just upx0 and upx1. We can see there are many
more DLL/API calls apparent in the unpacked version. Some suspicious ones that I have selected are CreateMutexA, OpenMutexA (tell if malware/this file is already running
on system), GetTickCount (analysis evasion), CreateDirectoryW, DeleteFileW, VirtualAllocEx (may be used for process hollowing), RegCreateKeyExAm, RegDeleteValueA (loads 
many, many more registry editing API calls than the few here), InternetOpenUrlA, and InternetReadFile. Some noticeable strings are "getcamsingleframe", "startcamcap",
"closecam", "initcamcap", "closecamera", "opencamera", "eventvwr.exe", "software\classes\mscfile\shell\open\command", "{ User has been idle for    minutes }", "Initializing connection
to C&C...", and "Connected to C&C!". There are other strings suggesting that this malware can copy saved passwords and logins, clipboards, an cookies. 

The unpacked version still has some cryptic sections, but in general makes it very obvious that unknown.exe is malware. It seems to have extensive spying capabilities like stealing saved information,
using the hosts camera, and transmitting this information to a C&C server. Unpacking UPX malware files is a great way to quickly and easily find out more information about said files.
